name: ğŸ› ï¸ Angular CI

on:
  push:
    branches: ["*"]
  pull_request:
    branches: ["*"]

jobs:
  build:
    runs-on: ubuntu-latest

    steps:
      - name: â¬‡ï¸ Checkout code
        uses: actions/checkout@v3

      - name: ğŸŸ¢ Use Node.js
        uses: actions/setup-node@v3
        with:
          node-version: '22'

      - name: ğŸ“¦ Install dependencies
        run: npm install

      - name: ğŸ§ª Run lint
        run: |
          npm run lint
          if [ $? -ne 0 ]; then
            echo "Linting failed. Please fix linting issues."
            exit 1
          fi
        
      - name: ğŸƒâ€â™‚ï¸ Run tests
        run: |
          npm run test
          if [ $? -ne 0 ]; then
            echo "Tests failed. Please fix the failing tests."
            exit 1
          fi

      - name: ğŸš€ Build app
        run: npm run build

      - name: ğŸ”„ Check for outdated dependencies
        run: |
          echo "Checking for outdated dependencies..."
          OUTDATED=$(npm outdated --json || true)
          if [ -n "$OUTDATED" ] && [ "$OUTDATED" != "{}" ]; then
            echo "Outdated dependencies found. Please consider updating the following:"
            echo "$OUTDATED"
          else
            echo "All dependencies are up to date."
          fi
